#!/bin/bash

RESET="\033[0m"
BLUE="\033[1;34m"
GREEN="\033[1;32m"
CYAN="\033[1;36m"
YELLOW="\033[1;33m"
MAGENTA="\033[1;35m"
RED="\033[1;31m"

SHOW_WELCOME=true
for arg in "$@"; do
  if [ "$arg" == "--no-welcome" ]; then
    SHOW_WELCOME=false
  fi
done

TERMINAL_WIDTH=$(tput cols)
if [ "$SHOW_WELCOME" == true ]; then
  figlet -c -w"$TERMINAL_WIDTH" -fslant "Welcome, $(whoami)" | lolcat
else
  figlet -c -w"$TERMINAL_WIDTH" -fslant "Cleared for takeoff!" | lolcat
fi

echo -e "${YELLOW}ðŸ“… Date:     ${CYAN}$(date +'%A, %B %d, %Y')${RESET}"

LOAD=$(uptime | awk -F'load average:' '{print $2}' | sed 's/^ *//')
echo -e "${GREEN}ðŸ’» CPU Load: ${CYAN}${LOAD}${RESET}"

MEMORY_USED=$(free -h | awk '/^Mem:/ {print $3}')
MEMORY_TOTAL=$(free -h | awk '/^Mem:/ {print $2}')
echo -e "${MAGENTA}ðŸ’¾ Memory:   ${CYAN}$MEMORY_USED / $MEMORY_TOTAL${RESET}"

DISK_USED=$(df -h / | awk 'NR==2 {print $3}')
DISK_TOTAL=$(df -h / | awk 'NR==2 {print $2}')
DISK_PERCENT=$(df -h / | awk 'NR==2 {print $5}')
echo -e "${BLUE}ðŸ—„ï¸ Disk:     ${CYAN}$DISK_USED used ($DISK_PERCENT of $DISK_TOTAL)${RESET}"

SESSIONS=$(who | wc -l)
echo -e "${RED}ðŸ‘¥ Sessions: ${CYAN}$SESSIONS active${RESET}"

if command -v upower >/dev/null; then
  BATTERY=$(upower -i "$(upower -e | grep BAT)" | awk '/percentage/ {print $2}')
  [ -n "$BATTERY" ] && echo -e "${MAGENTA}ðŸ”‹ Battery:  ${CYAN}$BATTERY${RESET}"
fi
